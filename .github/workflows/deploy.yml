name: ğŸ“¦ æ‰“åŒ…å¹¶éƒ¨ç½²åˆ° Alwaysdata
on:
  push:
    branches: [main] # å½“ä½ ä¿®æ”¹ä»£ç æˆ–ç‚¹å‡»è¿è¡Œæ—¶è§¦å‘
  workflow_dispatch: # å…è®¸ä½ æ‰‹åŠ¨ç‚¹å‡»è¿è¡Œ

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: â¬‡ï¸ ä¸‹è½½ä»£ç 
        uses: actions/checkout@v4

      - name: âš™ï¸ è®¾ç½® Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # å»ºè®®ä¸ Alwaysdata ç‰ˆæœ¬ä¸€è‡´

      - name: ğŸ“¦ å®‰è£…æ‰€æœ‰ä¾èµ– (äº‘ç«¯)
        run: |
          npm install --production
          npm run build # å¦‚æœé¡¹ç›®éœ€è¦æ„å»ºï¼Œåœ¨è¿™é‡Œæ‰§è¡Œ

      - name: ğŸ“‚ é€šè¿‡ FTP ä¸Šä¼ åˆ° Alwaysdata
        uses: SamKirkland/FTP-Deploy-Action@v4.3.5
        with:
          server: ftp-ä½ çš„ç”¨æˆ·å.alwaysdata.net
          username: ${{ secrets.ALWAYSDATA_FTP_USER }}
          password: ${{ secrets.ALWAYSDATA_FTP_PWD }}
          local-dir: ./ # ä¸Šä¼ å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼ˆå« node_modulesï¼‰
          server-dir: /KVideo/ # Alwaysdata ä¸Šçš„ç›®æ ‡ç›®å½•
