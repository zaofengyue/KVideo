name: ğŸ“¦ ä»…æ‰“åŒ…ä¸éƒ¨ç½²
on: [workflow_dispatch]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: ğŸ› ï¸ å®‰è£…å®Œæ•´ä¾èµ– (åŒ…å« TypeScript)
        run: npm install  # å»æ‰ --productionï¼Œå®‰è£…å®Œæ•´ç¯å¢ƒ

      - name: ğŸ—ï¸ æ„å»ºé¡¹ç›® (Build)
        run: npm run build  # è¿™ä¸€æ­¥ç°åœ¨èƒ½æ‰¾åˆ° typescript äº†

      - name: ğŸ§¹ æ¸…ç†å¼€å‘ä¾èµ– (å‡å°ä½“ç§¯)
        run: |
          rm -rf node_modules
          npm install --production  # é‡æ–°å®‰è£…ä»…ç”Ÿäº§ç¯å¢ƒéœ€è¦çš„åŒ…ï¼Œé€‚åˆ 100MB ç©ºé—´

      - name: ğŸ“¦ å‹ç¼©æ–‡ä»¶
        run: zip -r release.zip . -x ".git/*" ".github/*"

      - name: ğŸ“¤ ä¸Šä¼ æˆå“
        uses: actions/upload-artifact@v4
        with:
          name: kvideo-release
          path: release.zip
